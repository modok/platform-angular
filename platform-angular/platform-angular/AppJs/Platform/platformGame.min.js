angular.module("Platform",["Platform.directives","Platform.controllers","Platform.services","ngRoute"]);angular.module("Platform.directives",[]);angular.module("Platform.controllers",[]);angular.module("Platform.services",[]);angular.module("Platform.directives").directive("player",["levelObjects",function(n){return{restrict:"E",require:"^screen",replace:!0,scope:{x:"=",y:"=",speed:"=",jump:"="},templateUrl:"/AppJs/Platform/views/directives/playerDirective.html",link:function(t,i,r,u){t.screenBottom=t.y*u.getTileDimension().height+20;t.screenLeft=t.x*u.getTileDimension().width;n.addPlayer(i,{x:t.x,y:t.y,speed:t.speed,jump:t.jump*u.getTileDimension().height+i.height()*2,scope:t})}}}]);angular.module("Platform.directives").directive("floor",["levelObjects",function(n){return{restrict:"E",replace:!0,scope:{},templateUrl:"/AppJs/Platform/views/directives/floorDirective.html",link:function(t,i){n.setFloor(i)}}}]);angular.module("Platform.directives").directive("screen",["screenService",function(n){return{restrict:"E",replace:!0,priority:1,transclude:!0,scope:{width:"=",height:"="},controller:function(n){this.getTileDimension=function(){return n.tileDimension}},templateUrl:"/AppJs/Platform/views/directives/screenDirective.html",link:{pre:function(t){n.setGridDimension(t.width,t.height);t.tileDimension=n.getTileDimension()}}}}]);angular.module("Platform.directives").directive("platform",["levelObjects",function(n){return{restrict:"E",require:"^screen",replace:!0,scope:{x:"=",y:"=",width:"=",height:"="},templateUrl:"/AppJs/Platform/views/directives/platformDirective.html",link:function(t,i,r,u){t.screenWidth=t.width*u.getTileDimension().width;t.screenHeight=t.height*u.getTileDimension().height;t.screenBottom=t.y*u.getTileDimension().height+20;t.screenLeft=t.x*u.getTileDimension().width;n.addPlatform(i,{x:t.x,y:t.y,width:t.width,height:t.height,screenWidth:t.screenWidth,screenHeight:t.screenHeight,screenBottom:t.screenBottom,screenLeft:t.screenLeft})}}}]);angular.module("Platform.directives").directive("money",["levelObjects",function(n){return{restrict:"E",require:"^screen",replace:!0,scope:{x:"=",y:"="},templateUrl:"/AppJs/Platform/views/directives/moneyDirective.html",link:function(t,i,r,u){t.screenBottom=t.y*u.getTileDimension().height+20+i.height()/2;t.screenLeft=t.x*u.getTileDimension().width;n.addMoney(i,{x:t.x,y:t.y,screenBottom:t.screenBottom,screenLeft:t.screenLeft})}}}]);angular.module("Platform.directives").directive("score",[function(){return{restrict:"E",replace:!0,scope:{},templateUrl:"/AppJs/Platform/views/directives/scoreDirective.html",link:function(n){n.score=0;n.$on("score",function(){n.score=n.score+1;n.$digest()})}}}]);angular.module("Platform.directives").directive("start",["screenService","physicService","collideService","levelObjects",function(n,t,i,r){return{restrict:"E",replace:!0,scope:{},templateUrl:"/AppJs/Platform/views/directives/startDirective.html",link:function(u){u.isStarted=!1;u.start=function(){i.init(r);n.run();t.activate();u.isStarted=!0}}}}]);angular.module("Platform.services").factory("screenService",["$log","$document","levelObjects","$window","inputs",function(n,t,i,r,u){return new function(){var n=this;this._config={dimension:{width:1,height:1},tileDimension:{width:0,height:0}};this.setGridDimension=function(t,i){n._config.dimension.width=t;n._config.dimension.height=i;n._config.tileDimension.width=r.innerWidth/t;n._config.tileDimension.height=r.innerHeight/i};this.getTileDimension=function(){return n._config.tileDimension};this.getGridDimension=function(){return n._config.dimension};this.getScreenDimension=function(){return{width:r.innerWidth,height:r.innerHeight}};this.run=function(){t.keydown(function(n){n.keyCode===39?u.right=!0:n.keyCode===37?u.left=!0:n.keyCode===38&&(u.up=!0)});t.keyup(function(n){n.keyCode===39?u.right=!1:n.keyCode===37?u.left=!1:n.keyCode===38&&(u.up=!1)})}}}]);angular.module("Platform").factory("levelObjects",["platformFactory","playerFactory","moneyFactory",function(n,t,i){return new function(){var r=this;r._objects=[];r._player=null;r._floor=null;r.addPlayer=function(n,i){r._player=t.create(n,i)};r.addPlatform=function(t,i){r._objects.push(n.create(t,i))};r.addMoney=function(n,t){r._objects.push(i.create(n,t))};r.setFloor=function(n){r._floor=n}}}]);angular.module("Platform.services").factory("physicService",["$log","inputs","levelObjects","$window","collideService",function(n,t,i,r,u){return new function(){function e(){r.requestAnimationFrame(function(){t.left&&n.left();t.right&&n.right();t.up?n.jump():n.stopJumping=!0;var i=n._el.position().top;u.hitTheFloor(n,f)?(n.y=0,n.isJumping=!1,n.stopJumping=!1):(n._el.css({bottom:r.innerHeight-i-n._el.height()-f*1.5}),n.y-=f);e()})}var o=this,f=4,n=null;this.activate=function(){n=i._player;e()}}}]);angular.module("Platform.services").factory("collideService",["$log","inputs","$window","$rootScope",function(n,t,i,r){return new function(){function u(t){r.$broadcast("score");n._levelObjects._objects[t]._el.remove()}function f(n){return n._el.width()+n._el.position().left}function e(n){return n._el.position().left}function o(n){return n._el.position().top}function s(n){return n._el.height()+n._el.position().top}var n=this;this.init=function(n){this._levelObjects=n};this.hitTheObject=function(r,h){for(var c=0,g=n._levelObjects._objects.length;c<g;c++){var l=n._levelObjects._objects[c],y=f(r),a=e(r),v=o(r),p=s(r),w=f(l),b=e(l),k=o(l),d=s(l);if(t.right&&(y+h>b&&a+h<w&&p>k&&v<d||y+h>i.innerWidth)||t.left&&(a-h>b&&a-h<w&&p>k&&v<d||a-h<0)||t.up&&(v-h<d&&y>b&&a<w&&p>k||v-h<0))return l.type=="point"?(u(c),!1):!0}return!1};this.hitTheFloor=function(t,r){for(var h=0,l=n._levelObjects._objects.length;h<l;h++){var c=n._levelObjects._objects[h],v=f(t),y=e(t),p=o(t),a=s(t),w=f(c),b=e(c),k=o(c),d=s(c);if(a+r>k&&p+r<d&&v>b&&y<w||a+r>i.innerHeight-20)return c.type=="point"?(u(h),!1):!0}return!1}}}]);angular.module("Platform.services").factory("scoreService",["$log",function(){return new function(){var n=this;n.value=0}}]);angular.module("Platform.services").factory("platformFactory",[function(){var n=function(){var n=function(n,t){var i=this;i._el=n;i._config=t;i.type="wall"};this.create=function(t,i){return new n(t,i)}};return new n}]);angular.module("Platform.services").factory("playerFactory",["collideService",function(n){var t=function(){var t=function(n,t,i){function u(){var n=r._el.position().top;return r.y+=r._config.speed*3,window.innerHeight-n-r._el.height()+r._config.speed*3}var r=this;r.collideService=i;r.isJumping=!1;r.stopJumping=!1;r.y=0;r._el=n;r._config=t;r.left=function(){i.hitTheObject(r,r._config.speed)||r._el.css({left:r._el.position().left-r._config.speed})};r.right=function(){i.hitTheObject(r,r._config.speed)||r._el.css({left:r._el.position().left+r._config.speed})};r.jump=function(){!i.hitTheObject(r,r._config.speed*3)&&r.y<r._config.jump&&!r.stopJumping?r._el.css({bottom:u()}):r.stopJumping=!0}};this.collideService=n;this.create=function(n,i){return new t(n,i,this.collideService)}};return new t}]);angular.module("Platform.services").factory("moneyFactory",[function(){var n=function(){var n=function(n,t){var i=this;i._el=n;i._config=t;i.type="point"};this.create=function(t,i){return new n(t,i)}};return new n}]);angular.module("Platform.controllers").controller("main",["$scope","screenService",function(){}]);angular.module("Platform").value("inputs",{up:!1,down:!1,right:!1,left:!1}).run(["$log","$rootScope",function(){}]);
//# sourceMappingURL=platformGame.min.js.map
